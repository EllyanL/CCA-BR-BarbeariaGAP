<app-admin-navbar [containerClass]="'bloqueios-container'" [contentClass]="'bloqueios-content'">
  <div class="titulo">
    <h1>Usuários bloqueados pela regra de 15 dias</h1>
    <button mat-stroked-button color="primary" (click)="carregarBloqueados()" [disabled]="carregando">
      Atualizar
    </button>
  </div>

  <div class="estado" *ngIf="carregando">
    <mat-spinner diameter="40"></mat-spinner>
  </div>

  <div class="estado" *ngIf="!carregando && erroCarregamento">
    <p>Ocorreu um erro ao carregar os dados. Tente novamente.</p>
  </div>

  <div class="estado" *ngIf="!carregando && !erroCarregamento && dataSource.data.length === 0">
    <p>Nenhum usuário está bloqueado pela regra de 15 dias no momento.</p>
  </div>

  <table mat-table [dataSource]="dataSource" class="mat-elevation-z8" *ngIf="!carregando && dataSource.data.length > 0">
    <ng-container matColumnDef="postoGrad">
      <th mat-header-cell *matHeaderCellDef>Posto/Grad</th>
      <td mat-cell *matCellDef="let militar">{{ militar.postoGrad || '—' }}</td>
    </ng-container>

    <ng-container matColumnDef="nome">
      <th mat-header-cell *matHeaderCellDef>Nome</th>
      <td mat-cell *matCellDef="let militar">{{ obterNome(militar) }}</td>
    </ng-container>

    <ng-container matColumnDef="saram">
      <th mat-header-cell *matHeaderCellDef>SARAM</th>
      <td mat-cell *matCellDef="let militar">{{ militar.saram || '—' }}</td>
    </ng-container>

    <ng-container matColumnDef="categoria">
      <th mat-header-cell *matHeaderCellDef>Categoria</th>
      <td mat-cell *matCellDef="let militar">{{ militar.categoria || '—' }}</td>
    </ng-container>

    <ng-container matColumnDef="ultimaData">
      <th mat-header-cell *matHeaderCellDef>Último agendamento</th>
      <td mat-cell *matCellDef="let militar">{{ militar.ultimaData | date: 'dd/MM/yyyy' }}</td>
    </ng-container>

    <ng-container matColumnDef="diasRestantes">
      <th mat-header-cell *matHeaderCellDef>Dias restantes</th>
      <td mat-cell *matCellDef="let militar">{{ militar.diasRestantes }}</td>
    </ng-container>

    <ng-container matColumnDef="acoes">
      <th mat-header-cell *matHeaderCellDef>Ações</th>
      <td mat-cell *matCellDef="let militar">
        <button mat-raised-button color="accent" (click)="liberar(militar)">
          Liberar
        </button>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
  </table>
</app-admin-navbar>
