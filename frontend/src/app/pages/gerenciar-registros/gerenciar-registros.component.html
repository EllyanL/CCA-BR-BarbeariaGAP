<app-admin-navbar [containerClass]="'gerenciar-container'" [contentClass]="'gerenciar-content'">
  <div class="filters">
    <mat-form-field appearance="fill" class="search-field">
      <mat-label>Buscar</mat-label>
      <input matInput (input)="applyFilter($event)" placeholder="Buscar" />
    </mat-form-field>
    <mat-form-field appearance="fill" class="date-field">
      <mat-label>Data Inicial</mat-label>
      <input matInput [matDatepicker]="pickerInicio" [(ngModel)]="dataInicial" (dateChange)="carregarAgendamentos()" />
      <mat-datepicker-toggle matSuffix [for]="pickerInicio"></mat-datepicker-toggle>
      <mat-datepicker #pickerInicio></mat-datepicker>
    </mat-form-field>
    <mat-form-field appearance="fill" class="date-field">
      <mat-label>Data Final</mat-label>
      <input matInput [matDatepicker]="pickerFim" [(ngModel)]="dataFinal" (dateChange)="carregarAgendamentos()" />
      <mat-datepicker-toggle matSuffix [for]="pickerFim"></mat-datepicker-toggle>
      <mat-datepicker #pickerFim></mat-datepicker>
    </mat-form-field>
  </div>

  <mat-tab-group (selectedIndexChange)="onTabChange($event)">
    <mat-tab label="Graduados">
      <div class="export-container">
        <button mat-raised-button color="primary" (click)="exportarPdf()">Exportar PDF</button>
      </div>
      <ng-container *ngIf="dataSourceGraduados.filteredData.length; else noGraduados">
        <table mat-table [dataSource]="dataSourceGraduados" matSort class="mat-elevation-z8">
          <ng-container matColumnDef="data">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Data</th>
            <td mat-cell *matCellDef="let a">{{ toBrDate(a.data) }}</td>
          </ng-container>
          <ng-container matColumnDef="hora">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Hora</th>
            <td mat-cell *matCellDef="let a">{{ a.hora }}</td>
          </ng-container>
          <ng-container matColumnDef="nomeDeGuerra">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Nome de Guerra</th>
            <td mat-cell *matCellDef="let a">{{ formatName(a.militar?.nomeDeGuerra) }}</td>
          </ng-container>
          <ng-container matColumnDef="postoGrad">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Posto/Graduação</th>
            <td mat-cell *matCellDef="let a">{{ a.militar?.postoGrad }}</td>
          </ng-container>
          <ng-container matColumnDef="email">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>E-mail</th>
            <td mat-cell *matCellDef="let a">{{ a.militar?.email }}</td>
          </ng-container>
          <ng-container matColumnDef="secao">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Seção</th>
            <td mat-cell *matCellDef="let a">{{ a.militar?.secao }}</td>
          </ng-container>
          <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
            <td mat-cell *matCellDef="let a">
              <span [ngClass]="statusClass(a.status)">{{ formatarStatus(a.status) }}</span>
            </td>
          </ng-container>
          <ng-container matColumnDef="canceladoPor">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Cancelado Por</th>
            <td mat-cell *matCellDef="let a">{{ a.canceladoPor }}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
        <mat-paginator #graduadosPaginator [pageSize]="10" [pageSizeOptions]="[5,10,20]" showFirstLastButtons></mat-paginator>
      </ng-container>
      <ng-template #noGraduados>
        <div class="no-data">Nenhum agendamento encontrado</div>
      </ng-template>
    </mat-tab>

    <mat-tab label="Oficiais">
      <div class="export-container">
        <button mat-raised-button color="primary" (click)="exportarPdf()">Exportar PDF</button>
      </div>
      <ng-container *ngIf="dataSourceOficiais.filteredData.length; else noOficiais">
        <table mat-table [dataSource]="dataSourceOficiais" matSort class="mat-elevation-z8">
          <ng-container matColumnDef="data">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Data</th>
            <td mat-cell *matCellDef="let a">{{ toBrDate(a.data) }}</td>
          </ng-container>
          <ng-container matColumnDef="hora">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Hora</th>
            <td mat-cell *matCellDef="let a">{{ a.hora }}</td>
          </ng-container>
          <ng-container matColumnDef="nomeDeGuerra">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Nome de Guerra</th>
            <td mat-cell *matCellDef="let a">{{ formatName(a.militar?.nomeDeGuerra) }}</td>
          </ng-container>
          <ng-container matColumnDef="postoGrad">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Posto/Graduação</th>
            <td mat-cell *matCellDef="let a">{{ a.militar?.postoGrad }}</td>
          </ng-container>
          <ng-container matColumnDef="email">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>E-mail</th>
            <td mat-cell *matCellDef="let a">{{ a.militar?.email }}</td>
          </ng-container>
          <ng-container matColumnDef="secao">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Seção</th>
            <td mat-cell *matCellDef="let a">{{ a.militar?.secao }}</td>
          </ng-container>
          <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
            <td mat-cell *matCellDef="let a">
              <span [ngClass]="statusClass(a.status)">{{ formatarStatus(a.status) }}</span>
            </td>
          </ng-container>
          <ng-container matColumnDef="canceladoPor">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Cancelado Por</th>
            <td mat-cell *matCellDef="let a">{{ a.canceladoPor }}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
        <mat-paginator #oficiaisPaginator [pageSize]="10" [pageSizeOptions]="[5,10,20]" showFirstLastButtons></mat-paginator>
      </ng-container>
      <ng-template #noOficiais>
        <div class="no-data">Nenhum agendamento encontrado</div>
      </ng-template>
    </mat-tab>
  </mat-tab-group>
</app-admin-navbar>
