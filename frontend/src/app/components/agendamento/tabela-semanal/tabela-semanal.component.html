<mat-card class="tabela-card" *ngIf="usuarioCarregado">
  <mat-card-content class="tabela-card-content">
    <!-- Mensagem de Feedback -->
    <div *ngIf="feedbackMessageTitle" class="feedback-message">
      {{ feedbackMessageTitle }}
    </div>

    <!-- Tabela Principal -->
    <table class="tabela">
      <thead class="tabela-header">
        <tr>
          <th>HORÁRIO</th>
          <th *ngFor="let labelDia of diasComData; let i = index; trackBy: trackByIndex" class="tabela-header-dia">
            {{ labelDia | uppercase }}
          </th>
        </tr>
      </thead>
      <tbody class="tabela-body">
        <tr *ngFor="let hora of horariosBaseSemana; trackBy: trackByHora" class="tabela-linha-horario">
          <td class="tabela-coluna-horario">
            {{ hora }}
          </td>
          <td *ngFor="let dia of diasDaSemana; trackBy: trackByDia" class="tabela-coluna-dia">
            <ng-container *ngIf="getHorarioStatus(dia, hora.trim()) as status">
              <ng-container [ngSwitch]="status.acao">
                <!-- DISPONIVEL para agendar -->
                <div *ngSwitchCase="'agendar'" class="tabela-botao-container">
                  <button
                    title="{{ hora }}"
                    mat-raised-button
                    class="tabela-botao-disponivel"
                    [color]="status.cor"
                    (click)="agendarCorte(getLabelDiaComData(dia), hora)"
                    [@agendarAnimacao]
                    [disabled]="desabilitarTodosOsBotoes()"
                  >
                    {{ formatarStatus(status.texto) }}
                  </button>
                </div>

                <!-- Agendado pelo usuário logado -->
                <div *ngSwitchCase="'cancelar'" class="tabela-botao-container">
                  <button
                    *ngIf="isAgendamentoDesmarcavel(getAgendamentoParaDiaHora(dia, hora), dia, hora); else agendadoSemCancelar"
                    class="tabela-botao botao-agendado"
                    (click)="handleClick(getAgendamentoParaDiaHora(dia, hora), dia, hora)"
                    [attr.title]="getTextTooltip(getAgendamentoParaDiaHora(dia, hora))"
                    [@cancelarAnimacao]
                  >
                    {{ formatarStatus(status.texto) }}
                  </button>
                  <ng-template #agendadoSemCancelar>
                    <button class="tabela-botao botao-agendado" disabled>
                      {{ formatarStatus(status.texto) }}
                    </button>
                  </ng-template>
                </div>

                <!-- Agendado por outro usuário -->
                <div *ngSwitchCase="'ocupado'" class="tabela-botao-container">
                  <button
                    class="tabela-botao botao-agendado-outro"
                    disabled
                    title="Horário já agendado por outro usuário"
                  >
                    {{ formatarStatus(status.texto) }}
                  </button>
                </div>

                <!-- Indisponivel -->
                <div *ngSwitchDefault class="tabela-horario-indisponivel" [attr.title]="feedbackMessageTitle || 'Este horário não está disponivel nesta semana'">
                  <button mat-raised-button disabled class="tabela-botao-indisponivel">
                    {{ formatarStatus(status.texto) }}
                  </button>
                </div>
              </ng-container>
            </ng-container>
          </td>
        </tr>
      </tbody>
    </table>

  </mat-card-content>
</mat-card>
