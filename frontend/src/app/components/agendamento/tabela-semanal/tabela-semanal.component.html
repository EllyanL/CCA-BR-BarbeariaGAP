<mat-card class="tabela-card" *ngIf="usuarioCarregado">
  <mat-card-content class="tabela-card-content">
    <!-- Mensagem de Feedback -->
    <div *ngIf="feedbackMessageTitle" class="feedback-message">
      {{ feedbackMessageTitle }}
    </div>

    <!-- Tabela Principal -->
    <table class="tabela">
      <thead class="tabela-header">
        <tr>
          <th>HORÁRIO</th>
          <th *ngFor="let labelDia of diasComData; let i = index; trackBy: trackByIndex" class="tabela-header-dia">
            {{ labelDia | uppercase }}
          </th>
        </tr>
      </thead>
      <tbody class="tabela-body">
        <tr *ngFor="let hora of horariosBaseSemana; trackBy: trackByHora" class="tabela-linha-horario">
          <td class="tabela-coluna-horario">
            {{ hora }}
          </td>
          <td *ngFor="let dia of diasDaSemana; trackBy: trackByDia" class="tabela-coluna-dia">
            <ng-container *ngIf="getStatus(dia, hora.trim()) as status">
              <ng-container [ngSwitch]="status">
                <!-- DISPONIVEL para agendar -->
                <div *ngSwitchCase="'DISPONIVEL'" class="tabela-botao-container">
                  <button
                    title="{{ hora }}"
                    mat-raised-button
                    class="tabela-botao-disponivel"
                    [ngClass]="statusClass(status)"
                    (click)="agendarCorte(getLabelDiaComData(dia), hora)"
                    [@agendarAnimacao]
                    [disabled]="desabilitarTodosOsBotoes() || !isHoraAgendavel(hora)"
                  >
                    {{ formatarStatus(status) }}
                  </button>
                </div>

                <!-- Agendado pelo usuário logado ou outro -->
                <div *ngSwitchCase="'AGENDADO'" class="tabela-botao-container">
                  <button
                    *ngIf="isAgendamentoDesmarcavel(getAgendamentoParaDiaHora(dia, hora), dia, hora); else agendadoSemCancelar"
                    class="tabela-botao botao-agendado"
                    [ngClass]="statusClass(status)"
                    (click)="handleClick(getAgendamentoParaDiaHora(dia, hora), dia, hora)"
                    [attr.title]="getTextTooltip(getAgendamentoParaDiaHora(dia, hora))"
                    [@cancelarAnimacao]
                  >
                    {{ formatarStatus(status) }}
                  </button>
                  <ng-template #agendadoSemCancelar>
                    <button class="tabela-botao botao-agendado" [ngClass]="statusClass(status)" disabled>
                      {{ formatarStatus(status) }}
                    </button>
                  </ng-template>
                </div>

                <!-- Outros status (CANCELADO, REALIZADO, INDISPONIVEL) -->
                <div *ngSwitchDefault class="tabela-horario-indisponivel" [attr.title]="feedbackMessageTitle || 'Este horário não está disponivel nesta semana'">
                  <button mat-raised-button disabled class="tabela-botao-indisponivel" [ngClass]="statusClass(status)">
                    {{ formatarStatus(status) }}
                  </button>
                </div>
              </ng-container>
            </ng-container>
          </td>
        </tr>
      </tbody>
    </table>

  </mat-card-content>
</mat-card>
